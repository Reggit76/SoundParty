{% extends "base/base.html" %}
{% block title %}Панель администратора — Sound Party{% endblock %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">Главная</a></li>
    <li class="breadcrumb-item active" aria-current="page">Админ-панель</li>
  </ol>
</nav>
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>
    <i class="fas fa-tachometer-alt"></i> Панель администратора
  </h1>
  <span class="badge bg-danger fs-6">
    <i class="fas fa-user-shield"></i> Администратор
  </span>
</div>

<!-- Основная статистика -->
<div class="row g-4 mb-4">
  <div class="col-xl-3 col-md-6">
    <div class="card border-left-primary shadow h-100 py-2">
      <div class="card-body">
        <div class="row no-gutters align-items-center">
          <div class="col mr-2">
            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
              Пользователи
            </div>
            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ stats.users_count }}</div>
          </div>
          <div class="col-auto">
            <i class="fas fa-users fa-2x text-gray-300"></i>
          </div>
        </div>
        <div class="mt-2">
          <a href="/admin/users" class="btn btn-outline-primary btn-sm">
            <i class="fas fa-arrow-right"></i> Управление
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="col-xl-3 col-md-6">
    <div class="card border-left-success shadow h-100 py-2">
      <div class="card-body">
        <div class="row no-gutters align-items-center">
          <div class="col mr-2">
            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
              Мероприятия
            </div>
            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ stats.events_count }}</div>
          </div>
          <div class="col-auto">
            <i class="fas fa-calendar-alt fa-2x text-gray-300"></i>
          </div>
        </div>
        <div class="mt-2">
          <a href="/admin/events" class="btn btn-outline-success btn-sm">
            <i class="fas fa-arrow-right"></i> Управление
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="col-xl-3 col-md-6">
    <div class="card border-left-info shadow h-100 py-2">
      <div class="card-body">
        <div class="row no-gutters align-items-center">
          <div class="col mr-2">
            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
              Команды
            </div>
            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ stats.teams_count }}</div>
          </div>
          <div class="col-auto">
            <i class="fas fa-users-cog fa-2x text-gray-300"></i>
          </div>
        </div>
        <div class="mt-2">
          <a href="/admin/teams" class="btn btn-outline-info btn-sm">
            <i class="fas fa-arrow-right"></i> Управление
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="col-xl-3 col-md-6">
    <div class="card border-left-warning shadow h-100 py-2">
      <div class="card-body">
        <div class="row no-gutters align-items-center">
          <div class="col mr-2">
            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
              Заявки
            </div>
            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ stats.bookings_count }}</div>
          </div>
          <div class="col-auto">
            <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
          </div>
        </div>
        <div class="mt-2">
          <a href="/admin/bookings" class="btn btn-outline-warning btn-sm">
            <i class="fas fa-arrow-right"></i> Управление
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Дополнительная статистика -->
<div class="row g-4 mb-4">
  <div class="col-xl-4 col-md-6">
    <div class="card text-white bg-primary">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div>
            <h4>{{ stats.payments_count }}</h4>
            <p class="mb-0">Всего платежей</p>
          </div>
          <i class="fas fa-credit-card fa-2x opacity-50"></i>
        </div>
        <div class="progress mt-2" style="height: 5px;">
          <div class="progress-bar bg-white" role="progressbar" 
               style="width: {{ (stats.paid_payments / stats.payments_count * 100) if stats.payments_count > 0 else 0 }}%"></div>
        </div>
        <small>Оплачено: {{ stats.paid_payments }} из {{ stats.payments_count }}</small>
      </div>
      <div class="card-footer">
        <a href="/admin/payments" class="text-white text-decoration-none">
          Управление платежами <i class="fas fa-arrow-circle-right"></i>
        </a>
      </div>
    </div>
  </div>

  <div class="col-xl-4 col-md-6">
    <div class="card text-white bg-success">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div>
            <h4>{{ stats.venues_count }}</h4>
            <p class="mb-0">Площадки</p>
          </div>
          <i class="fas fa-building fa-2x opacity-50"></i>
        </div>
        <div class="mt-2">
          <small>Активные площадки для мероприятий</small>
        </div>
      </div>
      <div class="card-footer">
        <a href="/admin/venues" class="text-white text-decoration-none">
          Управление площадками <i class="fas fa-arrow-circle-right"></i>
        </a>
      </div>
    </div>
  </div>

  <div class="col-xl-4 col-md-6">
    <div class="card text-white bg-info">
      <div class="card-body">
        <div class="d-flex justify-content-between">
          <div>
            <h4>{{ stats.admin_count + stats.organizer_count }}</h4>
            <p class="mb-0">Персонал</p>
          </div>
          <i class="fas fa-user-tie fa-2x opacity-50"></i>
        </div>
        <div class="mt-2">
          <small>Админы: {{ stats.admin_count }}, Организаторы: {{ stats.organizer_count }}</small>
        </div>
      </div>
      <div class="card-footer">
        <a href="/admin/users" class="text-white text-decoration-none">
          Управление персоналом <i class="fas fa-arrow-circle-right"></i>
        </a>
      </div>
    </div>
  </div>
</div>

<!-- Быстрые действия и последние действия -->
<div class="row">
  <div class="col-lg-6">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-bolt"></i> Быстрые действия</h5>
      </div>
      <div class="card-body">
        <div class="d-grid gap-2">
          <a href="/admin/events/create" class="btn btn-success w-100">
            <i class="fas fa-calendar-plus"></i> Создать мероприятие
          </a>
          <a href="/admin/users/create" class="btn btn-primary w-100">
            <i class="fas fa-user-plus"></i> Добавить пользователя
          </a>
          <a href="/admin/venues/create" class="btn btn-info w-100">
            <i class="fas fa-map-marker-plus"></i> Добавить площадку
          </a>
          <a href="/admin/reports" class="btn btn-warning w-100">
            <i class="fas fa-chart-bar"></i> Отчеты
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-6">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-clock"></i> Последняя активность</h5>
      </div>
      <div class="card-body">
        <div class="activity-feed">
          <div class="activity-item d-flex align-items-center mb-3">
            <div class="activity-icon bg-success rounded-circle me-3 p-2">
              <i class="fas fa-user-plus text-white"></i>
            </div>
            <div class="activity-content">
              <p class="mb-0">Зарегистрирован новый пользователь</p>
              <small class="text-muted">5 минут назад</small>
            </div>
          </div>
          
          <div class="activity-item d-flex align-items-center mb-3">
            <div class="activity-icon bg-primary rounded-circle me-3 p-2">
              <i class="fas fa-calendar-alt text-white"></i>
            </div>
            <div class="activity-content">
              <p class="mb-0">Создано новое мероприятие</p>
              <small class="text-muted">1 час назад</small>
            </div>
          </div>
          
          <div class="activity-item d-flex align-items-center mb-3">
            <div class="activity-icon bg-warning rounded-circle me-3 p-2">
              <i class="fas fa-credit-card text-white"></i>
            </div>
            <div class="activity-content">
              <p class="mb-0">Поступила новая оплата</p>
              <small class="text-muted">2 часа назад</small>
            </div>
          </div>
          
          <div class="activity-item d-flex align-items-center">
            <div class="activity-icon bg-info rounded-circle me-3 p-2">
              <i class="fas fa-users text-white"></i>
            </div>
            <div class="activity-content">
              <p class="mb-0">Создана новая команда</p>
              <small class="text-muted">3 часа назад</small>
            </div>
          </div>
        </div>
        
        <div class="text-center mt-3">
          <a href="/admin/reports" class="btn btn-outline-primary btn-sm">
            <i class="fas fa-list"></i> Подробная активность
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.border-left-primary {
  border-left: 4px solid #4e73df !important;
}

.border-left-success {
  border-left: 4px solid #1cc88a !important;
}

.border-left-info {
  border-left: 4px solid #36b9cc !important;
}

.border-left-warning {
  border-left: 4px solid #f6c23e !important;
}

.activity-icon {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card {
  transition: transform 0.2s ease-in-out;
}

.card:hover {
  transform: translateY(-2px);
}

.btn i {
  display: block;
  margin-bottom: 5px;
}
</style>
{% endblock %}