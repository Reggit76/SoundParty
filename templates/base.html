<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Sound Party{% endblock %}</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <!-- Кастомный CSS -->
  <link href="/static/css/style.css" rel="stylesheet">
</head>
<body>
  <!-- Навигационное меню -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">
        <i class="fas fa-music"></i> Sound Party
      </a>
      
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      
      <div class="collapse navbar-collapse" id="navbarNav">
        <!-- Основное меню -->
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">
              <i class="fas fa-home"></i> Главная
            </a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="/events">
              <i class="fas fa-calendar-alt"></i> Мероприятия
            </a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="/teams">
              <i class="fas fa-users"></i> Команды
            </a>
          </li>
          
          <li class="nav-item">
            <a class="nav-link" href="/venues">
              <i class="fas fa-map-marker-alt"></i> Площадки
            </a>
          </li>
          
          <!-- Меню для авторизованных пользователей -->
          {% if current_user %}
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-gamepad"></i> Участие
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="/my-bookings">
                  <i class="fas fa-clipboard-list"></i> Мои заявки
                </a></li>
                <li><a class="dropdown-item" href="/my-team">
                  <i class="fas fa-user-friends"></i> Моя команда
                </a></li>
                <li><a class="dropdown-item" href="/results">
                  <i class="fas fa-trophy"></i> Результаты
                </a></li>
              </ul>
            </li>
          {% endif %}
          
          <!-- Административное меню (только для админов) -->
          {% if current_user and current_user.role_id == 1 %}
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-warning" href="#" id="adminDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-cog"></i> Админ
              </a>
              <ul class="dropdown-menu" aria-labelledby="adminDropdown">
                <li><h6 class="dropdown-header">Управление</h6></li>
                <li><a class="dropdown-item" href="/admin/events">
                  <i class="fas fa-calendar-plus"></i> Мероприятия
                </a></li>
                <li><a class="dropdown-item" href="/admin/venues">
                  <i class="fas fa-building"></i> Площадки
                </a></li>
                <li><a class="dropdown-item" href="/admin/teams">
                  <i class="fas fa-users-cog"></i> Команды
                </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><h6 class="dropdown-header">Финансы</h6></li>
                <li><a class="dropdown-item" href="/admin/bookings">
                  <i class="fas fa-list-alt"></i> Заявки
                </a></li>
                <li><a class="dropdown-item" href="/admin/payments">
                  <i class="fas fa-credit-card"></i> Платежи
                </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><h6 class="dropdown-header">Система</h6></li>
                <li><a class="dropdown-item" href="/admin/users">
                  <i class="fas fa-user-shield"></i> Пользователи
                </a></li>
                <li><a class="dropdown-item" href="/admin/reports">
                  <i class="fas fa-chart-bar"></i> Отчеты
                </a></li>
              </ul>
            </li>
          {% endif %}
          
          <!-- Меню для организаторов -->
          {% if current_user and current_user.role_id == 2 %}
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle text-info" href="#" id="organizerDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-tools"></i> Организатор
              </a>
              <ul class="dropdown-menu" aria-labelledby="organizerDropdown">
                <li><a class="dropdown-item" href="/organizer/events">
                  <i class="fas fa-calendar-check"></i> Мои мероприятия
                </a></li>
                <li><a class="dropdown-item" href="/organizer/bookings">
                  <i class="fas fa-clipboard-check"></i> Заявки
                </a></li>
                <li><a class="dropdown-item" href="/organizer/results">
                  <i class="fas fa-medal"></i> Результаты
                </a></li>
              </ul>
            </li>
          {% endif %}
        </ul>
        
        <!-- Правое меню (профиль/авторизация) -->
        <ul class="navbar-nav">
          {% if current_user %}
            <!-- Уведомления -->
            <li class="nav-item dropdown">
              <a class="nav-link position-relative" href="#" id="notificationsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-bell"></i>
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size: 0.6em;">
                  3
                  <span class="visually-hidden">непрочитанных уведомлений</span>
                </span>
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationsDropdown" style="width: 300px;">
                <li><h6 class="dropdown-header">Уведомления</h6></li>
                <li><a class="dropdown-item" href="#">
                  <small class="text-muted">5 мин назад</small><br>
                  Новое мероприятие: Битва диджеев
                </a></li>
                <li><a class="dropdown-item" href="#">
                  <small class="text-muted">1 час назад</small><br>
                  Ваша заявка одобрена
                </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item text-center" href="/notifications">
                  Показать все
                </a></li>
              </ul>
            </li>
            
            <!-- Профиль пользователя -->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="fas fa-user-circle"></i> {{ current_user.fullname or current_user.username }}
              </a>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                <li><h6 class="dropdown-header">{{ current_user.email }}</h6></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="/profile">
                  <i class="fas fa-user-edit"></i> Профиль
                </a></li>
                <li><a class="dropdown-item" href="/settings">
                  <i class="fas fa-cog"></i> Настройки
                </a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item text-danger" href="/logout">
                  <i class="fas fa-sign-out-alt"></i> Выйти
                </a></li>
              </ul>
            </li>
          {% else %}
            <!-- Кнопки входа/регистрации -->
            <li class="nav-item">
              <a class="nav-link" href="/login">
                <i class="fas fa-sign-in-alt"></i> Войти
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link btn btn-outline-light btn-sm ms-2" href="/register">
                <i class="fas fa-user-plus"></i> Регистрация
              </a>
            </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </nav>

  <!-- Основной контент -->
  <div class="container">
    <!-- Хлебные крошки (опционально) -->
    {% block breadcrumbs %}{% endblock %}
    
    <!-- Флеш-сообщения -->
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.type }} alert-dismissible fade show" role="alert">
          {{ message.text }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}
    
    <!-- Основной контент страницы -->
    {% block content %}{% endblock %}
  </div>

  <!-- Футер -->
  <footer class="bg-dark text-light mt-5 py-4">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <h5><i class="fas fa-music"></i> Sound Party</h5>
          <p class="text-muted">Платформа для организации музыкальных мероприятий и соревнований.</p>
        </div>
        <div class="col-md-3">
          <h6>Ссылки</h6>
          <ul class="list-unstyled">
            <li><a href="/about" class="text-light">О нас</a></li>
            <li><a href="/rules" class="text-light">Правила</a></li>
            <li><a href="/contact" class="text-light">Контакты</a></li>
          </ul>
        </div>
        <div class="col-md-3">
          <h6>Поддержка</h6>
          <ul class="list-unstyled">
            <li><a href="/help" class="text-light">Помощь</a></li>
            <li><a href="/faq" class="text-light">FAQ</a></li>
            <li><a href="/feedback" class="text-light">Обратная связь</a></li>
          </ul>
        </div>
      </div>
      <hr class="text-muted">
      <div class="row">
        <div class="col-md-6">
          <small class="text-muted">&copy; 2025 Sound Party. Все права защищены.</small>
        </div>
        <div class="col-md-6 text-end">
          <small class="text-muted">Версия 1.0.0</small>
        </div>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Кастомный JS -->
  <script src="/static/js/main.js"></script>
  
  <!-- Дополнительные скрипты -->
  {% block scripts %}{% endblock %}
</body>
</html>